<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Calculadora de Ecuaciones y Desigualdades</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f5f8fa;
      color: #2c3e50;
      padding: 40px;
      max-width: 800px;
      margin: auto;
    }

    h1 {
      color: #34495e;
    }

    input, button {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      margin-top: 10px;
      box-sizing: border-box;
    }

    button {
      background-color: #2ecc71;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background-color: #27ae60;
    }

    .resultado {
      background: #ffffff;
      margin-top: 25px;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
    }

    .item {
      margin-bottom: 15px;
    }

    .error {
      color: red;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <h1>ü§ñ Calculadora Inteligente</h1>
  <p>Escribe una expresi√≥n como:<br>
     <code>2x + 3 = 7</code> (ecuaci√≥n) ‚Äî 
     <code>x¬≤ - 4 ‚â• 0</code> (desigualdad) ‚Äî 
     <code>5 + 3 * 2</code> (expresi√≥n num√©rica)</p>

  <input type="text" id="desigualdad" placeholder="Escribe aqu√≠ tu ecuaci√≥n o desigualdad">
  <button onclick="resolverDesigualdad()">Resolver</button>

  <div class="resultado" id="resultado"></div>

  <script>
    function resolverDesigualdad() {
      const entrada = document.getElementById("desigualdad").value.trim().replace(/\s+/g, "");
      const resultado = document.getElementById("resultado");
      resultado.innerHTML = "";

      const desigualdadRegex = /(.+)(<=|>=|<|>)(.+)/;
      const igualdadRegex = /(.+)=([^=]+)/;

      try {
        if (desigualdadRegex.test(entrada)) {
          const match = entrada.match(desigualdadRegex);
          const izquierda = match[1];
          const operador = match[2];
          const derecha = match[3];
          const expr = `(${izquierda}) - (${derecha})`;

          const cuadratica = expr.includes("x^2") || expr.includes("x*x") || expr.match(/x\*x|x¬≤/);
          cuadratica
            ? resolverCuadratica(expr, operador, resultado)
            : resolverLineal(expr, operador, resultado);

        } else if (igualdadRegex.test(entrada)) {
          const match = entrada.match(igualdadRegex);
          const izquierda = match[1];
          const derecha = match[2];
          const expr = `(${izquierda}) - (${derecha})`;

          const cuadratica = expr.includes("x^2") || expr.includes("x*x") || expr.match(/x\*x|x¬≤/);
          cuadratica
            ? resolverEcuacionCuadratica(expr, resultado)
            : resolverEcuacionLineal(expr, resultado);

        } else {
          if (entrada.includes("x")) {
            resultado.innerHTML = `<div class="item">ü§ñ ${hablaBot("faltaOperador")}</div>`;
          } else {
            const valor = eval(entrada);
            resultado.innerHTML = `<div class="item">ü§ñ ${hablaBot("expresionNumerica", valor)}</div>`;
          }
        }

      } catch (e) {
        resultado.innerHTML = `<div class="item error">ü§ñ ${hablaBot("error")}</div>`;
      }
    }

    function resolverEcuacionLineal(expr, resultado) {
      const re = /([-+]?\d*\.?\d*)x/;
      const match = expr.match(re);
      const a = parseFloat(match[1] || (match[1] === "" ? 1 : 0));
      const b = eval(expr.replace(re, ""));

      if (a === 0) {
        resultado.innerHTML = b === 0
          ? `<div class="item">ü§ñ ${hablaBot("ecuacionLineal", "x ‚àà ‚Ñù (infinitas soluciones)")}</div>`
          : `<div class="item">ü§ñ ${hablaBot("ecuacionSinSol")}</div>`;
      } else {
        const x = -b / a;
        resultado.innerHTML = `<div class="item">ü§ñ ${hablaBot("ecuacionLineal", x)}</div>`;
      }
    }

    function resolverEcuacionCuadratica(expr, resultado) {
      const f = new Function("x", `return ${expr.replace(/x¬≤/g, "x*x").replace(/x\^2/g, "x*x")};`);
      const f0 = f(0), f1 = f(1), f_1 = f(-1);
      const a = f1 - 2 * f0 + f_1;
      const b = (f1 - f_1) / 2;
      const c = f0;
      const D = b * b - 4 * a * c;

      if (D < 0) {
        resultado.innerHTML = `<div class="item">ü§ñ ${hablaBot("ecuacionSinSol")}</div>`;
      } else if (D === 0) {
        const r = -b / (2 * a);
        resultado.innerHTML = `<div class="item">ü§ñ ${hablaBot("ecuacionCuadraticaDoble", r)}</div>`;
      } else {
        const r1 = (-b + Math.sqrt(D)) / (2 * a);
        const r2 = (-b - Math.sqrt(D)) / (2 * a);
        resultado.innerHTML = `<div class="item">ü§ñ ${hablaBot("ecuacionCuadratica", [r1, r2])}</div>`;
      }
    }

    function resolverLineal(expr, operador, resultado) {
      const re = /([-+]?\d*\.?\d*)x/;
      const match = expr.match(re);
      const a = parseFloat(match[1] || (match[1] === "" ? 1 : 0));
      const b = eval(expr.replace(re, ""));
      let mensaje = "";

      if (a === 0) {
        mensaje = eval(`0 ${operador} ${b}`) ? "x ‚àà ‚Ñù" : "No hay soluci√≥n";
      } else {
        const x = -b / a;
        const signos = { "<": "x < ", "<=": "x ‚â§ ", ">": "x > ", ">=": "x ‚â• " };
        mensaje = `${signos[operador]}${x}`;
      }

      resultado.innerHTML = `<div class="item">ü§ñ ${hablaBot("desigualdadLineal", mensaje)}</div>`;
    }

    function resolverCuadratica(expr, operador, resultado) {
      const f = new Function("x", `return ${expr.replace(/x¬≤/g, "x*x").replace(/x\^2/g, "x*x")};`);
      const f0 = f(0), f1 = f(1), f_1 = f(-1);
      const a = f1 - 2 * f0 + f_1;
      const b = (f1 - f_1) / 2;
      const c = f0;
      const D = b * b - 4 * a * c;
      let sol = "";

      if (D < 0) {
        sol = ((a > 0 && operador === ">") || (a < 0 && operador === "<")) ?
          "x ‚àà ‚Ñù" : "No hay soluci√≥n";
      } else if (D === 0) {
        const r = -b / (2 * a);
        sol = (operador === ">" || operador === "<") ?
          `x ‚àà ‚Ñù, x ‚â† ${r}` : `x = ${r}`;
      } else {
        const r1 = (-b + Math.sqrt(D)) / (2 * a);
        const r2 = (-b - Math.sqrt(D)) / (2 * a);
        const [min, max] = [Math.min(r1, r2), Math.max(r1, r2)];

        if (a > 0) {
          if (operador === ">") sol = `x < ${min} o x > ${max}`;
          if (operador === ">=") sol = `x ‚â§ ${min} o x ‚â• ${max}`;
          if (operador === "<") sol = `x ‚àà (${min}, ${max})`;
          if (operador === "<=") sol = `x ‚àà [${min}, ${max}]`;
        } else {
          if (operador === "<") sol = `x < ${min} o x > ${max}`;
          if (operador === "<=") sol = `x ‚â§ ${min} o x ‚â• ${max}`;
          if (operador === ">") sol = `x ‚àà (${min}, ${max})`;
          if (operador === ">=") sol = `x ‚àà [${min}, ${max}]`;
        }
      }

      resultado.innerHTML = `<div class="item">ü§ñ ${hablaBot("desigualdadCuadratica", sol)}</div>`;
    }

    function hablaBot(tipo, datos) {
      switch (tipo) {
        case "ecuacionLineal":
          return `¬°Listo! Resolviendo la ecuaci√≥n, obtengo que x vale ${datos}.`;
        case "ecuacionCuadratica":
          return `He resuelto tu ecuaci√≥n cuadr√°tica. Las soluciones son: x = ${datos[0]} y x = ${datos[1]}.`;
        case "ecuacionCuadraticaDoble":
          return `Esta ecuaci√≥n tiene una √∫nica soluci√≥n doble: x = ${datos}.`;
        case "ecuacionSinSol":
          return `Lo siento... esta ecuaci√≥n no tiene soluci√≥n real. üòï`;
        case "desigualdadLineal":
          return `La soluci√≥n de tu desigualdad es: ${datos}`;
        case "desigualdadCuadratica":
          return `Resolviendo tu desigualdad cuadr√°tica, encontr√© que: ${datos}`;
        case "expresionNumerica":
          return `Eso es solo una expresi√≥n. El resultado es: ${datos}`;
        case "faltaOperador":
          return `Parece que olvidaste escribir un signo de igualdad (=) o desigualdad (<, >, ‚â§, ‚â•).`;
        case "error":
          return `Ups... algo no sali√≥ bien. Revisa tu expresi√≥n.`;
        default:
          return `Hmm... no entend√≠ tu entrada. ¬øPodr√≠as intentarlo de nuevo?`;
      }
    }
  </script>

</body>
</html>

